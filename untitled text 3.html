
<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>max stein - sound</title>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />

	<link href='http://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
	<link href='_/css/style.css' rel='stylesheet' type='text/css'>

	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-26321268-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>

</head>

<body>

	<section>
		<h4>field recordings</h4>
		<div style="font-size:12px; width:75%; float:left; height:400px;"><head>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<meta Http-Equiv="Cache-Control" Content="no-cache">
	<meta Http-Equiv="Pragma" Content="no-cache">
	<meta Http-Equiv="Expires" Content="0"> 

	<title></title>	


<script type="text/javascript"
    src="http://maps.googleapis.com/maps/api/js?sensor=false">
</script>

	



	<script type="text/javascript" src="http://www.maxstein.net/js/jquery.min.js"></script>

	<script type="text/javascript" src="http://www.maxstein.net/js/slimbox2.js"></script>

	<script type='text/javascript' src="http://www.maxstein.net/embed/swfobject.js"></script>


<script type="text/javascript">

	var gmarkers2 = [];

function initialize() {


	var latlng = new google.maps.LatLng(45.50240, -73.56514);
	var myOptions = {
		zoom: 17,
		center: latlng,
//		mapTypeId: google.maps.MapTypeId.ROADMAP
		mapTypeId: google.maps.MapTypeId.SATELLITE
	};

	var map = new google.maps.Map(document.getElementById("map"), myOptions);


	//declare infowindow outside of createMarker to only allow one infowindow at a time

	var gmarkers = [];


	var infowindow = new google.maps.InfoWindow();


	google.maps.event.addListener(map, "click", function(){
		infowindow.close();
	});


    function createMarker(encoded, latitude, longitude, type, user_id, author, sidelink, location, dir, soundfile, download, complete, equipment, duration, image_lg, image_sm, spectro_lg, spectro_sm, time, date, description, sound_ext, tag_one, tag_two, tag_three, tag_four) {

		var staticIcon = new google.maps.MarkerImage('http://www.maxstein.net/images/sine.png',
		  // This marker is 20 pixels wide by 32 pixels tall.
			new google.maps.Size(18, 18),
		  // The origin for this image is 0,0.
			new google.maps.Point(0,0),
		  // The anchor for this image is the base of the flagpole at 0,32.
			new google.maps.Point(0,0));

		var shadow = new google.maps.MarkerImage('http://www.maxstein.net/images/shadow-sine.png',
			new google.maps.Size(38, 25),
			new google.maps.Point(0,0),
			new google.maps.Point(5, 2));

		var myLatLng = new google.maps.LatLng(latitude, longitude);


if ( encoded == "X" )
	{
		var mp3 = "<embed src = 'http://www.maxstein.net/embed/player.swf' width='250' height='24' flashvars='file=http://montrealsoundmap.com/media/audio/" + dir + "/" + soundfile + "&autostart=true'>";
		var pcm = "<object width=\"250\" height=\"19\"><param name=\"src\" value='http://montrealsoundmap.com/media/audio/" + dir + "/" + soundfile + "'><param name=\"autoplay\" value=\"true\"><param name=\"controller\" value=\"true\"><embed src='http://montrealsoundmap.com/media/audio/" + dir + "/" + soundfile + "' type=\"'application/x-mplayer2','application/x-quicktimeplayer'\" autostart=\"true\" loop=\"false\" width=\"250\" height=\"25\" controller=\"true\"></embed></object></b></a>";
	} else {
		var mp3 = "<embed src = 'http://www.maxstein.net/embed/player.swf' width='250' height='24' flashvars='file=http://depot.montrealsoundmap.com/montreal/media/audio/" + dir + "/" + soundfile + "&autostart=true'>";
		var pcm = "<object width=\"250\" height=\"19\"><param name=\"src\" value='http://depot.montrealsoundmap.com/montreal/media/audio/" + dir + "/" + soundfile + "'><param name=\"autoplay\" value=\"true\"><param name=\"controller\" value=\"true\"><embed src='http://depot.montrealsoundmap.com/montreal/media/audio/" + dir + "/" + soundfile + "' type=\"'application/x-mplayer2','application/x-quicktimeplayer'\" autostart=\"true\" loop=\"false\" width=\"250\" height=\"25\" controller=\"true\"></embed></object></b></a>";
	}


		var play = "";


//determine whether flash player or browser player
		if ( sound_ext == ".mp3" )
			{ play = mp3; }
		else { play = pcm;}

		var infoWindowContent;

		if ( tag_two != "N/A" ) { tag_two = ", " + tag_two; } else { tag_two = ""; }
		if ( tag_three != "N/A" ) { tag_three = ", " + tag_three; } else { tag_three = ""; } 
		if ( tag_four != "N/A" ) { tag_four = ", " + tag_four; } else { tag_four = ""; } 

		var tags = tag_one + tag_two + tag_three + tag_four;

		if ( tag_one == 'N/A' ) { tags = 'N/A' };

	

infoWindowContent = "<div style='margin:10px;'><div style='width:250px;'><b>" + location +" - " + date + " @ " + time + "</b></div>" + "<center><div style='margin-top:10px; margin-bottom:10px;'>"+ play + "</div></center><div style='width:250px;'>" + description +"</div></div>";



		var marker = new google.maps.Marker({
			position: myLatLng,
			map: map,
			shadow: shadow,
			icon: staticIcon,
			title: location
	    });


		google.maps.event.addListener(marker, 'click', function() {
			infowindow.close();
        	infowindow.setContent(infoWindowContent);
        	infowindow.open(map, marker);
		}); 


		gmarkers2.push(marker);

		return marker;

	}



// This function picks up the click and opens the corresponding info window



	//get info from database in json format
	$.getJSON('http://www.maxstein.net/map/files.php', function(data) {

		$.each(data, function(key, val) {

			gmarkers.push([
				val.user_id,
				val.encoded,
				val.author,
				val.dir,
				val.email,
				val.type,
				val.website,
				val.location,
				val.latitude,
				val.longitude,
				val.datetime,
				val.date,
				val.date_link,
				val.time,
				val.duration,
				val.equipment,
				val.binaural,
				val.description,
				val.cc,
				val.soundfile,
				val.download,
				val.complete,
				val.sound_ext,
				val.image_lg,
				val.image_sm,
				val.spectro_lg,
				val.spectro_sm,
				val.tag_one,
				val.tag_two,
				val.tag_three,
				val.tag_four,
				val.sidelink
			])

		});

			for (var i = 0; i < gmarkers.length; i++) {

				var user_id = gmarkers[i][0];
				var encoded = gmarkers[i][1];
				var author = gmarkers[i][2];
				var dir = gmarkers[i][3];
				var email = gmarkers[i][4];
				var type = gmarkers[i][5];
				var website = gmarkers[i][6];
				var location = gmarkers[i][7];
				var latitude = gmarkers[i][8];
				var longitude = gmarkers[i][9];
				var datetime = gmarkers[i][10];
				var date = gmarkers[i][11];
				var date_link = gmarkers[i][12];
				var time = gmarkers[i][13];
				var duration = gmarkers[i][14];
				var equipment = gmarkers[i][15];
				var binaural = gmarkers[i][16];
				var description = gmarkers[i][17];
				var cc = gmarkers[i][18];
				var soundfile = gmarkers[i][19];
				var download = gmarkers[i][20];
				var complete = gmarkers[i][21];
				var sound_ext = gmarkers[i][22];
				var image_lg = gmarkers[i][23];
				var image_sm = gmarkers[i][24];
				var spectro_lg = gmarkers[i][25];
				var spectro_sm = gmarkers[i][26];
				var tag_one = gmarkers[i][27];
				var tag_two = gmarkers[i][28];
				var tag_three = gmarkers[i][29];
				var tag_four = gmarkers[i][30];
				var sidelink = gmarkers[i][31];

 				var marker = createMarker(encoded, latitude, longitude, type, user_id, author, sidelink, location, dir, soundfile, download, complete, equipment, duration, image_lg, image_sm, spectro_lg, spectro_sm, time, date, description, sound_ext, tag_one, tag_two, tag_three, tag_four);

			}



		});


}

	function myclick(i) {
	  google.maps.event.trigger(gmarkers2[i], "click");
	}


</script>


</head>
<body onload="initialize()">
  <div id="map" style="width:100%; height:100%"></div>
</body>


</div>

	</section>

<script>
	document.addEventListener("touchstart", function() {},false);
</script>

</body>

</html>
